<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tip Split App</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 16px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    }
    h2, h3 {
      margin-top: 24px;
    }
    input {
      padding: 8px 10px;
      margin: 4px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
      width: 90px;
    }
    button {
      padding: 8px 14px;
      border-radius: 8px;
      border: none;
      background: #2563eb;
      color: white;
      font-size: 14px;
      cursor: pointer;
    }
    button.secondary {
      background: #6b7280;
    }
    .row {
      margin-bottom: 10px;
    }
    .card {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 12px;
      margin-top: 12px;
      background: #fafafa;
    }
    ul {
      padding-left: 18px;
    }
    hr {
      margin: 30px 0;
    }
  </style>
</head>
<body>
<div class="container">
  <h2>üí∞ Tip Split App</h2>

  <button id="modeBtn">‚û° Weekend</button>

  <h3>üè¢ Floors</h3>
  <div id="floors"></div>

  <h3>‚ûï Extra Tip</h3>
  <input id="extraTip" inputmode="numeric" placeholder="0" />

  <h3>üìä Result</h3>
  <div id="result"></div>

  <hr />

  <h2>‚è±Ô∏è ÏãúÍ∞Ñ Í∏∞Ï§Ä Ï∂îÍ∞Ä ÌåÅ Î∂ÑÎ∞∞</h2>

  <div class="row">
    Î∂ÑÎ∞∞Ìï† Í∏àÏï°
    <input id="hourAmount" inputmode="numeric" placeholder="0" />
  </div>

  <div id="hourRows"></div>

  <button class="secondary" id="addServer">+ Add Server</button>

  <div id="hourResult"></div>
</div>

<script>
let mode = "weekday";

const floors = {
  1: { cash: "", card: "" },
  2: { cash: "", card: "" },
  3: { cash: "", card: "" }
};

const percentRows = [
  { id: 1, percent: "", count: "" },
  { id: 2, percent: "", count: "" },
  { id: 3, percent: "", count: "" },
  { id: 4, percent: "", count: "" }
];

let hourRows = [
  { id: 1, name: "", hours: "" },
  { id: 2, name: "", hours: "" }
];

const n = v => Number(v || 0);

function floorTotal(f) {
  return n(f.cash) + n(f.card) + (mode === "weekend" ? 25 : 0);
}

function render() {
  renderFloors();
  renderResult();
  renderHour();
}

function renderFloors() {
  const wrap = document.getElementById("floors");
  wrap.innerHTML = "";

  [1,2,...(mode==="weekend"?[3]:[])].forEach(f=>{
    const d = document.createElement("div");
    d.className = "row";
    d.innerHTML = `
      <b>${f}F</b>
      Cash <input inputmode="numeric" value="${floors[f].cash}">
      Card <input inputmode="numeric" value="${floors[f].card}">
    `;
    const inputs = d.querySelectorAll("input");
    inputs[0].oninput = e => floors[f].cash = e.target.value;
    inputs[1].oninput = e => floors[f].card = e.target.value;
    wrap.appendChild(d);
  });

  percentRows.forEach(r=>{
    const d = document.createElement("div");
    d.className = "row";
    d.innerHTML = `
      % <input inputmode="numeric" value="${r.percent}">
      Count <input inputmode="numeric" value="${r.count}">
    `;
    const i = d.querySelectorAll("input");
    i[0].oninput = e => r.percent = e.target.value;
    i[1].oninput = e => r.count = e.target.value;
    wrap.appendChild(d);
  });
}

function renderResult() {
  const extra = n(document.getElementById("extraTip").value);
  const total = floorTotal(floors[1]) + floorTotal(floors[2]) + extra;

  let rows = percentRows
    .map(r => ({ p: n(r.percent)/100, c: Math.floor(n(r.count)) }))
    .filter(r => r.p>0 && r.c>0);

  if (!rows.length || total<=0) {
    document.getElementById("result").innerHTML = "";
    return;
  }

  const weight = rows.reduce((s,r)=>s+r.p*r.c,0);
  const base = Math.floor(total/weight);

  let html = `<div class="card"><b>Total:</b> $${total}<ul>`;
  let dist = 0;

  rows.forEach(r=>{
    const one = Math.floor(base*r.p);
    const sum = one*r.c;
    dist += sum;
    html += `<li>${r.p*100}% ‚Üí $${one} √ó ${r.c} = $${sum}</li>`;
  });

  html += `</ul><b>Leftover:</b> $${total-dist}</div>`;
  document.getElementById("result").innerHTML = html;
}

function renderHour() {
  const wrap = document.getElementById("hourRows");
  wrap.innerHTML = "";

  hourRows.forEach(r=>{
    const d = document.createElement("div");
    d.className = "row";
    d.innerHTML = `
      <input placeholder="Name" value="${r.name}">
      <input inputmode="numeric" placeholder="Hours" value="${r.hours}">
    `;
    const i = d.querySelectorAll("input");
    i[0].oninput = e => r.name = e.target.value;
    i[1].oninput = e => r.hours = e.target.value;
    wrap.appendChild(d);
  });

  const total = n(document.getElementById("hourAmount").value);
  const clean = hourRows.filter(r=>n(r.hours)>0);
  if (!total || !clean.length) {
    document.getElementById("hourResult").innerHTML="";
    return;
  }

  const hours = clean.reduce((s,r)=>s+n(r.hours),0);
  const per = total/hours;

  let html = `<div class="card"><div>Per hour: $${per.toFixed(2)}</div><ul>`;
  let dist = 0;

  clean.forEach(r=>{
    const tip = Math.floor(n(r.hours)*per);
    dist += tip;
    html += `<li>${r.name||"Unnamed"} ‚Üí $${tip}</li>`;
  });

  html += `</ul><b>Leftover:</b> $${total-dist}</div>`;
  document.getElementById("hourResult").innerHTML = html;
}

document.getElementById("modeBtn").onclick = ()=>{
  mode = mode==="weekday"?"weekend":"weekday";
  document.getElementById("modeBtn").innerText =
    mode==="weekday"?"‚û° Weekend":"‚û° Weekday";
  render();
};

document.getElementById("extraTip").oninput = render;
document.getElementById("hourAmount").oninput = render;

document.getElementById("addServer").onclick = ()=>{
  hourRows.push({ id: Date.now(), name:"", hours:"" });
  render();
};

render();
</script>
</body>
</html>
